webpackJsonp([12],{"/aKI":function(t,e){},"27Ty":function(t,e){},"2eg6":function(t,e){},"4ml/":function(t,e){},HSwN:function(t,e,n){"use strict";var a={props:["rule","err_message"],data:function(){return{isOk:!0}},methods:{showTips:function(){this.isOk||this.$toast.fail(this.err_message)},dataChange:function(t){if(t.target.value){var e=new RegExp(this.rule);this.isOk=e.test(t.target.value),this.$emit("input",t.target.value)}else this.isOk=!0},jump:function(){this.$emit("keyup")}}},s={render:function(){var t=this,e=t.$createElement;return(t._self._c||e)("input",{staticClass:"input",class:{error:!t.isOk},attrs:{type:"text"},on:{blur:t.showTips,input:t.dataChange,keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.jump(e)}}})},staticRenderFns:[]};var i=n("VU/8")(a,s,!1,function(t){n("2eg6")},"data-v-56ff8ac6",null);e.a=i.exports},NHnr:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n("7+uW"),s={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("keep-alive",{attrs:{include:"homePage"}},[e("router-view")],1)],1)},staticRenderFns:[]};var i=n("VU/8")({name:"App"},s,!1,function(t){n("/aKI")},null,null).exports,o=n("/ocq"),r=n("Gu7T"),c=n.n(r),l={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"header"},[n("span",{staticClass:"iconfont iconnew"}),t._v(" "),n("div",{staticClass:"search",on:{click:function(e){return t.$router.push("/search")}}},[n("span",{staticClass:"iconfont iconsearch"}),t._v("\n    搜索新闻\n  ")]),t._v(" "),n("span",{staticClass:"iconfont iconwode",on:{click:function(e){return t.$router.push("/profile")}}})])},staticRenderFns:[]};var u={name:"homePage",components:{homeHeader:n("VU/8")({},l,!1,function(t){n("vKMo")},"data-v-53581df8",null).exports,post:n("yIG7").a},data:function(){return{activeTab:localStorage.getItem("token")?1:0,tabList:[],loading:!1,finished:!1,pageIndex:1,pageSize:5}},mounted:function(){this.initTabList()},watch:{activeTab:function(t){0==this.tabList[t].posts.length&&this.getTabPosts(t)}},methods:{initTabList:function(){var t=this;if(localStorage.getItem("tabActive"))return this.tabList=JSON.parse(localStorage.getItem("tabActive")),void this.getTabPosts(this.activeTab);this.$axios({url:"/category",method:"GET"}).then(function(e){var n=e.data.data;n.forEach(function(t){t.posts=[],t.currentPage=1}),t.tabList=n,t.getTabPosts(t.activeTab),console.log(t.tabList)})},getTabPosts:function(t){var e=this,n=this.tabList[t].id;this.$axios({url:"/post",method:"GET",params:{category:n,pageIndex:this.tabList[t].currentPage,pageSize:this.pageSize}}).then(function(n){var a=n.data.data;console.log(a);var s=[].concat(c()(e.tabList[t].posts),c()(a));e.tabList[t].posts=s,a.length<e.pageSize&&(e.finished=!0)})},loadMorePost:function(){var t=this;setTimeout(function(){t.tabList[t.activeTab].currentPage+=1,t.loading=!1,t.getTabPosts(t.activeTab)},500)}}},p={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("homeHeader"),t._v(" "),n("van-tabs",{attrs:{sticky:"",swipeable:""},model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},[n("van-list",{attrs:{finished:t.finished,"immediate-check":!1,"finished-text":"没有更多了"},on:{load:t.loadMorePost},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.tabList,function(e,a){return n("van-tab",{key:a,attrs:{title:e.name}},t._l(e.posts,function(t,e){return n("post",{key:e,attrs:{post:t}})}),1)}),1)],1)],1)},staticRenderFns:[]};var d=n("VU/8")(u,p,!1,function(t){n("YcfM")},"data-v-32a80b2d",null).exports,m=n("HSwN"),h=n("gy0y"),f={data:function(){return{username:"",password:""}},components:{authInput:m.a,authBtn:h.a},methods:{setUserName:function(t){this.username=t},setPassword:function(t){this.password=t},sendLogin:function(){var t=this;console.log("username=",this.username,"password=",this.password),this.$axios({url:"/login",method:"POST",data:{username:this.username,password:this.password}}).then(function(e){if(console.log(e),200==e.data.statusCode){localStorage.setItem("token",e.data.data.token),localStorage.setItem("user_id",e.data.data.user.id),t.$toast.success(e.data.message);var n=setTimeout(function(){clearTimeout(n),t.$router.push({name:"homePage"})},1e3)}}).catch(function(t){console.log(t)})}}},v={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container"},[t._m(0),t._v(" "),t._m(1),t._v(" "),n("div",{staticClass:"inputName"},[n("authInput",{ref:"phone",attrs:{err_message:"请输入正确的手机号",phone:"phone",placeholder:"请输入手机号",rule:"^\\d{5,10}$"},on:{input:t.setUserName}})],1),t._v(" "),n("div",{staticClass:"inputPwd"},[n("authInput",{attrs:{err_message:"请输入正确的密码",placeholder:"请输入密码",rule:"^\\d{3,10}$",type:"password"},on:{input:t.setPassword,keyup:t.sendLogin}})],1),t._v(" "),n("div",{staticClass:"btn"},[n("authBtn",{attrs:{text:"登录"},on:{click:t.sendLogin}}),t._v(" "),n("div",{staticClass:"register"},[t._v("\n      还没有账号?\n      "),n("router-link",{attrs:{to:"/register"}},[t._v("请注册")])],1)],1)])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"closeBtn"},[e("span",{staticClass:"iconfont iconicon-test"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"logo"},[e("span",{staticClass:"iconfont iconnew"})])}]};var g=n("VU/8")(f,v,!1,function(t){n("udz4")},"data-v-4c23ed4a",null).exports;a.a.use(o.a);var _=new o.a({routes:[{path:"/",redirect:"/home"},{path:"/login",name:"loginPage",component:g},{path:"/register",name:"registerPage",component:function(){return n.e(10).then(n.bind(null,"hOe2"))}},{path:"/profile",name:"profilePage",component:function(){return Promise.all([n.e(0),n.e(4)]).then(n.bind(null,"qKQV"))}},{path:"/home",name:"homePage",component:d},{path:"/editProfile",name:"editProfile",component:function(){return Promise.all([n.e(0),n.e(3)]).then(n.bind(null,"wbS3"))}},{path:"/myFllow",name:"myFllowPage",component:function(){return Promise.all([n.e(0),n.e(9)]).then(n.bind(null,"DCly"))}},{path:"/myComments",name:"myCommentsPage",component:function(){return Promise.all([n.e(0),n.e(7)]).then(n.bind(null,"YGvO"))}},{path:"/myCollections",name:"myCollections",component:function(){return Promise.all([n.e(0),n.e(8)]).then(n.bind(null,"nyYL"))}},{path:"/postDetail/:id",name:"postDetailPage",component:function(){return n.e(1).then(n.bind(null,"t5Lq"))}},{path:"/search",name:"SearchPage",component:function(){return n.e(6).then(n.bind(null,"tnDH"))}},{path:"/moreComments/:id",name:"moreCommentsPage",component:function(){return Promise.all([n.e(0),n.e(2)]).then(n.bind(null,"vizL"))}},{path:"/tabManager",name:"tabManagerPage",component:function(){return Promise.all([n.e(0),n.e(5)]).then(n.bind(null,"feqA"))}}]}),b=n("mtWM"),P=n.n(b),C=n("Fd2+");n("4ml/");P.a.defaults.baseURL="http://111.230.181.206:3000",P.a.interceptors.request.use(function(t){return!t.headers.Authorization&&localStorage.getItem("token")&&(t.headers.Authorization=localStorage.getItem("token")),t}),P.a.interceptors.response.use(function(t){console.log("res:",t);var e=t.data,n=e.statusCode,a=e.message;return a&&401==n&&C.d.fail(a),"用户信息验证失败"==a&&_.push("/login"),t}),a.a.prototype.$axios=P.a,a.a.prototype.$fixImgUrl=function(t){return t.indexOf("http")<0?P.a.defaults.baseURL+t:t},_.beforeEach(function(t,e,n){var a=localStorage.getItem("token");if("/profile"==t.path||"/editProfile"==t.path)return a?n():n("/login");n()}),a.a.use(C.e),a.a.use(C.a,{lazyComponent:!0,loading:"/static/imgs/01.jpg"}),a.a.use(C.b),a.a.use(C.c),a.a.config.productionTip=!1,new a.a({el:"#app",router:_,components:{App:i},template:"<App/>",directives:{focus:{inserted:function(t){t.focus()}}}})},YcfM:function(t,e){},gy0y:function(t,e,n){"use strict";var a={render:function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"btn",on:{click:this.handleClick}},[this._v(this._s(this.text))])},staticRenderFns:[]};var s=n("VU/8")({props:["text"],methods:{handleClick:function(t){this.$emit("click")}}},a,!1,function(t){n("rNVa")},"data-v-516208f2",null);e.a=s.exports},rNVa:function(t,e){},udz4:function(t,e){},vKMo:function(t,e){},yIG7:function(t,e,n){"use strict";var a={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[2==t.post.type?n("div",{staticClass:"videoPost"},[n("div",{staticClass:"title",on:{click:t.toPostDetail}},[t._v(t._s(t.post.title))]),t._v(" "),n("div",{staticClass:"cover",on:{click:t.toPostDetail}},[n("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.$fixImgUrl(t.post.cover[0].url),expression:"$fixImgUrl(post.cover[0].url)"}],staticClass:"imgRight",attrs:{alt:""}}),t._v(" "),t._m(0)]),t._v(" "),n("div",{staticClass:"info"},[t._v(t._s(t.post.user.nickname)+" "+t._s(t.post.comment_length)+"跟帖")])]):t.post.cover.length>0&&t.post.cover.length<3?n("div",{staticClass:"single"},[n("div",{staticClass:"left"},[n("div",{staticClass:"title",on:{click:t.toPostDetail}},[t._v(t._s(t.post.title))]),t._v(" "),n("div",{staticClass:"info"},[t._v(t._s(t.post.user.nickname)+" "+t._s(t.post.comment_length)+"跟帖")])]),t._v(" "),n("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.$fixImgUrl(t.post.cover[0].url),expression:"$fixImgUrl(post.cover[0].url)"}],staticClass:"imgRight",on:{click:t.toPostDetail}})]):t.post.cover.length>=3?n("div",{staticClass:"multip"},[n("div",{staticClass:"title",on:{click:t.toPostDetail}},[t._v(t._s(t.post.title))]),t._v(" "),n("div",{staticClass:"cover"},t._l(3,function(e,a){return n("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.$fixImgUrl(t.post.cover[a].url),expression:"$fixImgUrl(post.cover[index].url)"}],key:a,attrs:{alt:""},on:{click:t.toPostDetail}})}),0),t._v(" "),n("div",{staticClass:"info"},[t._v(t._s(t.post.user.nickname)+" "+t._s(t.post.comment_length)+"跟帖")])]):t._e()])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"btnPlay"},[e("span",{staticClass:"iconfont iconshipin"})])}]};var s=n("VU/8")({props:["post"],methods:{toPostDetail:function(){this.$router.push({name:"postDetailPage",params:{id:this.post.id}})}}},a,!1,function(t){n("27Ty")},"data-v-08183df0",null);e.a=s.exports}},["NHnr"]);
//# sourceMappingURL=app.fe631b10fdf0eaf69f98.js.map